# GoldSight - Gold Price Prediction Web Application

A comprehensive machine learning project for predicting gold prices using multivariate deep learning models. This project achieves 99% prediction accuracy (R² = 0.990) by leveraging 19.5 years of historical data across 13 macroeconomic and financial indicators.

**Live Demo**: [https://goldsight.onrender.com](https://goldsight.onrender.com)

## Overview

GoldSight is an end-to-end machine learning system that predicts gold prices by analyzing the complex relationships between precious metal markets, equity indices, macroeconomic indicators, and geopolitical risks. The project includes:

- Interactive web application built with Reflex framework
- Systematic comparison of 14 different prediction models
- Professional data visualizations and exploratory analysis
- Production-ready deployment on Render.com

## Key Results

- **Best Model**: GRU Multivariate Neural Network
- **R-squared**: 0.990 (explains 99% of price variance)
- **Mean Absolute Error**: $34.94 (1.3% average error)
- **Dataset**: 233 monthly observations (Jan 2006 - Oct 2024)
- **Features**: 13 carefully selected economic indicators

## Quick Start

### Prerequisites

- Python 3.11+
- Git

### Installation

1. Clone the repository:
```bash
git clone https://github.com/HuyPham171-hub/gold-price-prediction.git
cd gold-price-prediction/Project
```

2. Create virtual environment:
```bash
python -m venv .venv
.venv\Scripts\activate  # Windows
# source .venv/bin/activate  # macOS/Linux
```

3. Install dependencies:
```bash
pip install -r requirements-dev.txt  # For development
# pip install -r requirements.txt    # For production only
```

4. Run the application:
```bash
reflex init
reflex run
```

Open your browser to `http://localhost:3000`

## Project Structure

```
Project/
├── goldsight/              # Web application
│   ├── pages/              # Page components (home, eda, modeling, forecast)
│   ├── components/         # Reusable UI components
│   ├── utils/              # Helper functions and design system
│   └── data/cache/         # Pre-generated Plotly charts (JSON)
├── data/
│   ├── combined_data.csv   # Full dataset (17 features)
│   ├── filtered_data.csv   # Selected features (13 features)
│   ├── raw/                # Original data sources
│   └── processed/          # Cleaned data
├── notebooks/              # Jupyter notebooks for analysis
├── models/                 # Saved model weights (.keras)
└── requirements.txt        # Production dependencies
```

## Features

### Data Collection
- 7 data sources integrated (Yahoo Finance, FRED, World Gold Council)
- 19.5 years of historical data (2006-2025)
- Monthly frequency with 233 observations

### Feature Set (13 variables)
- **Target**: Gold Spot Price
- **Precious Metals**: Silver Futures
- **Financial Markets**: S&P 500, VIX, Crude Oil, USD Index
- **Macroeconomic**: CPI, Unemployment, Fed Funds Rate, 10Y Treasury, Real Interest Rate
- **Geopolitical**: GPR, GPRA

### Model Comparison

| Model | Type | R² | RMSE | MAE |
|-------|------|-----|------|-----|
| **GRU Multivariate** | Deep Learning | **0.990** | $45.92 | **$34.94** |
| LSTM Multivariate | Deep Learning | 0.990 | $45.31 | $37.84 |
| SVR | Traditional ML | 0.986 | $59.93 | $43.77 |
| Random Forest | Traditional ML | 0.986 | $59.93 | $43.77 |
| Linear Regression | Baseline | 0.947 | $115.88 | $77.06 |
| ARIMA | Time Series | -0.480 | $503.12 | $321.93 |

Full comparison of 14 models available in the web application.

### Web Application

Interactive chapters guide users through the analysis:

1. **Data Collection**: Sources, integration process, dataset preview
2. **Exploratory Analysis**: Time series plots, distributions, correlation analysis
3. **Modeling**: Model comparison, performance metrics, architecture details
4. **Forecasting**: (Planned) Real-time predictions and scenario analysis

## Technology Stack

- **Frontend**: React (auto-generated by Reflex)
- **Backend**: FastAPI (Python)
- **ML Framework**: TensorFlow/Keras, Scikit-learn
- **Visualization**: Plotly, Matplotlib, Seaborn
- **Deployment**: Render.com
- **Data Processing**: Pandas, NumPy

## Usage

### Running Notebooks

```bash
pip install -r requirements-dev.txt
jupyter lab
```

Open `notebooks/explore.ipynb` for EDA or `notebooks/modeling.ipynb` for model training.

### Training Models

```python
import pandas as pd
from sklearn.model_selection import train_test_split

# Load data
df = pd.read_csv('data/filtered_data.csv')
X = df.drop(['Date', 'Gold_Spot'], axis=1)
y = df['Gold_Spot']

# Train-test split (80-20)
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, shuffle=False
)

# See notebooks/modeling.ipynb for complete implementation
```

### Deployment

The application is configured for automatic deployment on Render.com:

1. Push to GitHub
2. Connect repository to Render
3. Render will use `render.yaml` for build configuration
4. Application deploys automatically

## Methodology

### Data Pipeline
1. **Collection**: Aggregate data from 7 sources (2006-2024)
2. **Preprocessing**: Handle missing values, align timestamps, resample to monthly
3. **Feature Selection**: Remove multicollinearity using VIF analysis (17 → 13 features)
4. **Modeling**: Progressive approach from simple baselines to deep learning
5. **Evaluation**: Consistent metrics (R², RMSE, MAE) with 80-20 train-test split

### Key Findings
- Multivariate models vastly outperform univariate approaches (0.990 vs 0.270 R²)
- Traditional ML (SVR, Random Forest) achieves near-optimal results (0.986 R²)
- Deep learning provides marginal improvement with temporal modeling
- CPI, Silver Futures, and S&P 500 are the most important predictors

## Dependencies

### Production (`requirements.txt`)
```
reflex==0.8.17
pandas==2.2.2
numpy==1.26.4
plotly==5.24.0
openpyxl==3.1.5
xlrd==2.0.1
python-dateutil==2.9.0.post0
pytz==2025.2
```

### Development (`requirements-dev.txt`)
Includes production dependencies plus:
- Jupyter, JupyterLab
- Matplotlib, Seaborn
- Scikit-learn, Statsmodels
- Additional ML/analysis tools

See `REQUIREMENTS.md` for detailed dependency management.

## Future Work

- Ensemble methods (stacking GRU, LSTM, Random Forest)
- Attention mechanisms for interpretability
- Real-time data pipeline with API integration
- Multi-horizon forecasting (1-month, 3-month, 6-month)
- SHAP values for model explainability

## Contributing

This is an academic project developed for COMP1682.1 Final Project at the University of Greenwich. 

For questions or collaboration:
- Open an issue on GitHub
- Contact: Repository maintainer

## License

MIT License - See LICENSE file for details

## Acknowledgments

**Data Sources**:
- World Gold Council (Gold spot prices)
- Federal Reserve Economic Data - FRED (Macroeconomic indicators)
- Yahoo Finance (Market data)
- Economic Policy Uncertainty Index (Geopolitical risk)

**Frameworks**:
- Reflex (Web framework)
- TensorFlow/Keras (Deep learning)
- Scikit-learn (Machine learning)
- Plotly (Visualization)

## Contact

- **Repository**: [https://github.com/HuyPham171-hub/gold-price-prediction](https://github.com/HuyPham171-hub/gold-price-prediction)
- **Live App**: [https://goldsight.onrender.com](https://goldsight.onrender.com)

---

**Version**: 1.0.0  
**Last Updated**: November 2025  
**Status**: Active Development

## Table of Contents

1. [Introduction](#introduction)
2. [Research Objectives](#research-objectives)
3. [Methodology](#methodology)
4. [Data Collection](#data-collection)
5. [Exploratory Data Analysis](#exploratory-data-analysis)
6. [Feature Engineering](#feature-engineering)
7. [Model Development](#model-development)
8. [Results](#results)
9. [Web Application](#web-application)
10. [Installation](#installation)
11. [Project Structure](#project-structure)
12. [Dependencies](#dependencies)
13. [Usage](#usage)
14. [Future Work](#future-work)
15. [Contributors](#contributors)
16. [License](#license)

## Introduction

Gold has historically served as a safe-haven asset during economic uncertainty and a hedge against inflation. Accurate gold price prediction is crucial for investors, policymakers, and financial institutions. Traditional time series methods such as ARIMA and SARIMA have shown limitations in capturing the complex, non-linear relationships between gold prices and macroeconomic indicators.

This research addresses these limitations by employing multivariate deep learning models that simultaneously consider temporal patterns and cross-sectional relationships among economic variables. The project encompasses the entire machine learning pipeline: data collection, preprocessing, exploratory analysis, feature selection, model training, evaluation, and deployment through an interactive web application.

## Research Objectives

The primary objectives of this study are:

1. To collect and integrate diverse data sources including precious metal prices, equity market indices, macroeconomic indicators, and geopolitical risk measures.

2. To identify and eliminate multicollinearity through rigorous feature selection, reducing the initial 17 features to an optimal subset of 13 predictors.

3. To systematically compare the predictive performance of multiple modeling approaches:
   - Traditional time series models (ARIMA, SARIMA)
   - Linear regression and regularization methods (Ridge)
   - Classical machine learning algorithms (SVR, Random Forest, XGBoost)
   - Deep learning architectures (MLP, RNN, LSTM, GRU) in both univariate and multivariate configurations

4. To develop an accessible web-based interface for visualizing the analysis pipeline and prediction results.

5. To provide actionable insights into the relative importance of different economic factors in gold price determination.

## Methodology

### Research Design

This study follows a quantitative research design with the following phases:

**Phase 1: Data Acquisition and Integration**
Data spanning January 2006 to October 2024 was collected from multiple authoritative sources. The common start date of January 31, 2006 was established to ensure temporal alignment across all variables.

**Phase 2: Data Preprocessing**
Forward-fill imputation was applied to handle missing values while preserving temporal ordering. Datasets were merged on the date index to create a unified time series with 233 monthly observations.

**Phase 3: Exploratory Data Analysis**
Comprehensive statistical analysis was conducted to understand distributions, temporal patterns, and inter-variable relationships. Correlation analysis and 3D network visualization revealed complex dependency structures.

**Phase 4: Feature Selection**
Variance Inflation Factor (VIF) analysis and correlation matrix examination identified multicollinearity issues. Features exhibiting correlation coefficients above 0.95 or VIF values exceeding 10 were systematically removed, reducing the feature set from 17 to 13 variables.

**Phase 5: Model Development**
A progressive modeling strategy was employed, starting with simple baselines and incrementally adding complexity. Each model was evaluated using consistent train-test splits (80-20) and performance metrics (R-squared, RMSE, MAE).

**Phase 6: Deployment**
The optimal model and analytical visualizations were integrated into a Reflex-based web application, providing an interactive platform for exploring the research findings.

## Data Collection

### Data Sources

Data was aggregated from seven primary sources, each providing unique perspectives on factors influencing gold prices:

1. **Market Data (S&P 500, NASDAQ, Crude Oil, Silver Futures)**
   - Source: Yahoo Finance
   - Frequency: Daily, aggregated to monthly
   - Variables: Closing prices and futures contracts

2. **VIX (Volatility Index)**
   - Source: CBOE via Yahoo Finance
   - Frequency: Daily, aggregated to monthly
   - Purpose: Market sentiment and uncertainty indicator

3. **Macroeconomic Indicators**
   - Source: Federal Reserve Economic Data (FRED)
   - Variables: CPI, M2 Money Supply, Federal Funds Rate, Unemployment Rate, 10-Year Treasury Yield
   - Frequency: Monthly

4. **Real Interest Rate**
   - Source: FRED
   - Calculation: Nominal rate adjusted for inflation
   - Frequency: Monthly

5. **USD Index**
   - Source: Yahoo Finance
   - Purpose: Currency strength indicator
   - Frequency: Daily, aggregated to monthly

6. **Gold Spot Price**
   - Source: World Gold Council
   - Type: London Bullion Market spot prices
   - Frequency: Daily, aggregated to monthly

7. **Geopolitical Risk Indices (GPR, GPRT, GPRA)**
   - Source: Economic Policy Uncertainty Index
   - Variables: General geopolitical risk, threats, and acts
   - Frequency: Monthly

### Data Integration

The integration process involved:
- Standardizing date formats across all sources
- Resampling daily data to monthly frequency using end-of-month values
- Forward-filling missing observations to maintain temporal continuity
- Validating data integrity through statistical summaries and visualization

### Final Dataset Characteristics

- **Temporal Range**: January 31, 2006 to October 31, 2024
- **Observations**: 233 monthly data points
- **Initial Features**: 17 variables
- **Final Features**: 13 variables (after multicollinearity removal)
- **Target Variable**: Gold Spot Price (USD per troy ounce)

## Exploratory Data Analysis

### Temporal Patterns

Gold prices exhibited three distinct regimes during the study period:

1. **2006-2011**: Steady appreciation from approximately 600 USD to 1,900 USD, driven by the 2008 financial crisis and subsequent quantitative easing.

2. **2011-2019**: Consolidation phase with prices ranging between 1,100 USD and 1,400 USD, reflecting economic recovery and reduced safe-haven demand.

3. **2019-2024**: Resurgence to all-time highs above 2,700 USD, catalyzed by COVID-19 pandemic uncertainty, persistent inflation, and geopolitical tensions.

### Correlation Analysis

Pearson correlation analysis revealed the following key relationships:

**Strong Positive Correlations (r > 0.80)**
- Gold Spot vs. CPI: r = 0.85 (inflation hedge confirmation)
- Gold Spot vs. Silver Futures: r = 0.82 (precious metal co-movement)
- S&P 500 vs. NASDAQ: r = 0.99 (equity market redundancy)

**Strong Negative Correlations (r < -0.40)**
- Gold Spot vs. Real Interest Rate: r = -0.40 (opportunity cost effect)
- Gold Spot vs. USD Index: r = -0.35 (currency relationship)

**Multicollinearity Issues Identified**
- S&P 500 and NASDAQ (VIF > 50): NASDAQ removed
- CPI and M2 Money Supply (r = 0.91): M2 removed
- Gold Spot, Gold Futures, and Gold ETF (r > 0.99): Futures and ETF removed
- GPR and GPRT (r = 0.94): GPRT removed

### Feature Distributions

Distribution analysis revealed:
- Gold prices: Right-skewed with increasing variance over time
- VIX: Heavy-tailed distribution with occasional spikes during crises
- Macroeconomic indicators: Generally normal distributions with temporal trends
- Geopolitical risk indices: High kurtosis indicating sporadic extreme events

### Principal Component Analysis

3D PCA visualization demonstrated that the 13 selected features occupy distinct regions in feature space, with:
- PC1 (33.2% variance): Primarily driven by inflation-related variables
- PC2 (29.4% variance): Capturing market risk and volatility
- PC3 (14.6% variance): Reflecting geopolitical uncertainty

The spatial distribution confirmed minimal redundancy among the final feature set.

## Feature Engineering

### Multicollinearity Detection

Variance Inflation Factor (VIF) analysis was conducted iteratively:

**Initial VIF Results**
- S&P 500: VIF = 54.3
- NASDAQ: VIF = 52.1
- CPI: VIF = 15.7
- M2 Money Supply: VIF = 14.2

**Removal Strategy**
Features were removed in order of:
1. Highest pairwise correlation (r > 0.95)
2. Highest VIF (VIF > 10)
3. Domain knowledge consideration (economic interpretability)

**Final Feature Set (13 variables)**

Target Variable:
- Gold Spot Price

Predictor Variables:
1. **Precious Metals**: Silver Futures
2. **Financial Markets**: S&P 500, VIX, Crude Oil, USD Index
3. **Macroeconomic**: CPI, Unemployment Rate, 10-Year Treasury Yield, Real Interest Rate, Federal Funds Rate
4. **Geopolitical**: GPR (Geopolitical Risk Index), GPRA (Geopolitical Risk Acts)

All selected features exhibited VIF < 10 and pairwise correlations < 0.90, ensuring statistical independence.

## Model Development

### Baseline Models

**Linear Regression**
- R-squared: 0.947
- RMSE: 115.88 USD
- MAE: 77.06 USD
- Interpretation: Strong baseline indicating linear relationships capture 94.7% of variance

**Ridge Regression (L2 Regularization)**
- R-squared: 0.947
- RMSE: 115.88 USD
- MAE: 77.06 USD
- Finding: No improvement over ordinary least squares, confirming low multicollinearity after feature selection

**ARIMA (Autoregressive Integrated Moving Average)**
- R-squared: -0.480
- RMSE: 503.12 USD
- MAE: 321.93 USD
- Conclusion: Univariate time series approach insufficient; negative R-squared indicates worse performance than mean prediction

**SARIMA (Seasonal ARIMA)**
- R-squared: 0.270
- RMSE: 353.57 USD
- MAE: 233.26 USD
- Conclusion: Marginal improvement but still inadequate; gold prices lack strong seasonal patterns

### Traditional Machine Learning

**Support Vector Regression (RBF Kernel)**
- Hyperparameter tuning: GridSearchCV with 27 configurations, 5-fold cross-validation
- Optimal parameters: C=100, gamma=0.01, epsilon=0.01
- R-squared: 0.986
- RMSE: 59.93 USD
- MAE: 43.77 USD
- Advantage: Captures non-linear relationships through kernel transformation

**Random Forest**
- Configuration: 500 estimators, max depth 20, 1,620 cross-validation fits
- R-squared: 0.986
- RMSE: 59.93 USD
- MAE: 43.77 USD
- Feature importance: CPI (32%), Silver Futures (18%), S&P 500 (15%)
- Advantage: Ensemble approach reduces overfitting while capturing interactions

**XGBoost (Gradient Boosting)**
- R-squared: 0.973
- RMSE: 82.67 USD
- MAE: 51.11 USD
- Observation: Underperformed compared to SVR and Random Forest, possibly due to overfitting on training data

### Deep Learning - Univariate Models

**Multilayer Perceptron (MLP)**
- Architecture: 256-128-64-32-1 neurons with dropout (0.3, 0.2) and batch normalization
- Input: All 13 features simultaneously (no sequence)
- R-squared: 0.960
- RMSE: 100.62 USD
- MAE: 78.85 USD

**Simple RNN (Univariate)**
- Architecture: 64-64 recurrent units, dropout 0.2
- Input: 12-month sliding window of gold prices only
- R-squared: 0.600
- RMSE: 263.33 USD
- MAE: 184.26 USD
- Limitation: Lacks economic context; struggles with long-term dependencies

**LSTM (Univariate)**
- Architecture: 64-64 LSTM units with forget gates
- Input: 12-month sliding window of gold prices only
- R-squared: 0.603
- RMSE: 262.55 USD
- MAE: 193.85 USD
- Finding: Minimal improvement over simple RNN; gating mechanisms underutilized with univariate input

**GRU (Univariate)**
- Architecture: 64-64 GRU units
- Input: 12-month sliding window of gold prices only
- R-squared: 0.843
- RMSE: 164.93 USD
- MAE: 122.95 USD
- Observation: Outperforms LSTM univariate due to simpler gating structure reducing overfitting risk

### Deep Learning - Multivariate Models (Best Performance)

**RNN (Multivariate)**
- Architecture: 64-64 recurrent units
- Input: 12-month windows with 13 features per timestep
- R-squared: 0.972
- RMSE: 76.77 USD
- MAE: 58.99 USD
- Improvement: +0.372 R-squared over univariate RNN

**LSTM (Multivariate)**
- Architecture: 128-64 LSTM units, dropout 0.2, dense layers (32-1)
- Input: 12-month windows with 13 features per timestep
- Training: 70 epochs with early stopping, ReduceLROnPlateau callback
- R-squared: 0.990
- RMSE: 45.31 USD
- MAE: 37.84 USD
- Advantage: Forget gates effectively manage long-term dependencies across multiple feature dimensions

**GRU (Multivariate) - CHAMPION MODEL**
- Architecture: 128-64 GRU units, dropout 0.2, dense layers (32-1)
- Input: 12-month windows with 13 features per timestep
- Training: Adam optimizer, MSE loss, batch size 32
- Callbacks: EarlyStopping (patience=15), ReduceLROnPlateau, ModelCheckpoint
- R-squared: 0.990
- RMSE: 45.92 USD
- MAE: 34.94 USD
- Parameters: Approximately 50,000 trainable parameters
- Training time: ~5 minutes on CPU
- Advantages:
  - Lowest MAE among all models (best average prediction accuracy)
  - Faster training than LSTM (20% reduction)
  - Simpler architecture (2 gates vs. 3 in LSTM) sufficient for dataset complexity
  - Balanced trade-off between complexity and performance

### Performance Comparison Summary

| Model Category | Best Model | R-squared | RMSE (USD) | MAE (USD) |
|----------------|------------|-----------|------------|-----------|
| Baseline | Linear Regression | 0.947 | 115.88 | 77.06 |
| Traditional ML | SVR / Random Forest | 0.986 | 59.93 | 43.77 |
| Deep Learning Univariate | GRU | 0.843 | 164.93 | 122.95 |
| Deep Learning Multivariate | GRU | 0.990 | 45.92 | 34.94 |

Key insights:
1. Multivariate approaches vastly outperform univariate methods (0.990 vs. 0.270 for time series)
2. Deep learning provides marginal but consistent improvement over traditional ML (0.990 vs. 0.986)
3. Feature engineering is more impactful than model sophistication (Linear: 0.947 vs. ARIMA: -0.480)
4. GRU multivariate achieves production-grade accuracy with average error under 35 USD

## Results

### Key Findings

1. **Multivariate Superiority**: Incorporating macroeconomic features improves R-squared from 0.843 (GRU univariate) to 0.990 (GRU multivariate), a 17.4% relative improvement.

2. **Feature Importance**: CPI (inflation), Silver Futures (precious metal co-movement), and S&P 500 (market sentiment) emerged as the three most influential predictors.

3. **Model Complexity Trade-off**: Beyond R-squared of 0.986 (SVR/Random Forest), additional model complexity yields diminishing returns (0.004 improvement to GRU).

4. **Temporal Modeling Value**: Recurrent architectures (RNN/LSTM/GRU) capture temporal dependencies that tree-based methods miss, particularly during regime transitions (2008 crisis, COVID-19).

5. **Practical Accuracy**: The champion GRU model's MAE of 34.94 USD represents 1.3% average error at current gold prices (approximately 2,700 USD), suitable for decision support applications.

### Statistical Validation

**Out-of-Sample Performance**:
- Training set (186 observations): R-squared = 0.992
- Test set (47 observations): R-squared = 0.990
- Minimal overfitting observed

**Error Distribution**:
- Mean error: 2.1 USD (slight positive bias)
- Standard deviation of errors: 43.2 USD
- Maximum absolute error: 127 USD (occurred during COVID-19 market disruption)

**Residual Analysis**:
- Shapiro-Wilk test: p = 0.18 (normality assumption not rejected)
- Durbin-Watson statistic: 1.87 (minimal autocorrelation in residuals)
- Heteroscedasticity test: No significant pattern observed

## Web Application

### Architecture

The GoldSight web application was developed using the Reflex framework, a Python-based reactive web framework that enables rapid development of data-driven applications without JavaScript.

**Technology Stack**:
- Frontend: React (auto-generated by Reflex)
- Backend: FastAPI (Python)
- Visualization: Plotly for interactive charts
- Deployment: Render.com (serverless platform)

### Application Structure

The application follows a chapter-based narrative structure:

**Chapter 1: Data Collection**
- Overview of data sources and acquisition methodology
- Interactive table displaying the first 10 rows of the integrated dataset
- Metric cards showing dataset dimensions (17 features, 19.5 years, 233 observations)

**Chapter 2: Exploratory Data Analysis**
- Gold price time series with annotated historical events (2008 crisis, 2024 all-time high)
- Distribution analysis across four categories (target variable, market indicators, macroeconomic variables, volatility indices)
- Correlation heatmap with hierarchical clustering
- 3D correlation network visualization
- Interactive accordion UI explaining network interpretation
- Multicollinearity detection table
- Feature selection rationale with before/after comparison

**Chapter 3: Modeling & Evaluation**
- Executive summary with key performance metrics
- Progressive comparison tables (baseline → traditional ML → deep learning)
- Model architecture diagrams for neural networks
- Hyperparameter configurations
- Grand leaderboard ranking all 14 models
- Insight boxes highlighting key learnings

**Chapter 4: Forecasting** (Planned)
- Real-time prediction interface
- Scenario analysis (what-if simulations)
- Model explainability (SHAP values)
- Uncertainty quantification

### Design System

The application employs a consistent design language:
- Color scheme: Amber (gold theme) for primary actions, complementary colors for data categories
- Typography: Hierarchical heading sizes (8 levels) for clear information architecture
- Spacing: 8px base unit with consistent multipliers
- Components: Reusable accordion, card, table, and chart components
- Responsive layout: Maximum width constraints for optimal readability
- Dark mode support: Automatic color adaptation based on user preference

### Deployment

The application is deployed on Render.com with the following configuration:
- Region: Singapore (optimal latency for Asia-Pacific users)
- Build command: Install dependencies, initialize Reflex, export frontend assets
- Start command: Run backend-only server (frontend pre-built)
- Environment: Python 3.11.9, minimal production dependencies
- URL: https://goldsight.onrender.com (deployed instance)

## Installation

### Prerequisites

- Python 3.11 or higher
- Git for version control
- Virtual environment manager (venv or conda)

### Local Development Setup

1. Clone the repository:
```bash
git clone https://github.com/HuyPham171-hub/gold-price-prediction.git
cd gold-price-prediction/Project
```

2. Create and activate virtual environment:
```bash
# Windows
python -m venv .venv
.venv\Scripts\activate

# macOS/Linux
python3 -m venv .venv
source .venv/bin/activate
```

3. Install development dependencies:
```bash
pip install -r requirements-dev.txt
```

4. Initialize Reflex:
```bash
reflex init
```

5. Run the application:
```bash
reflex run
```

The application will be accessible at `http://localhost:3000`.

### Production Deployment

For production deployment on Render.com:

1. Ensure `requirements.txt` contains only production dependencies
2. Configure `render.yaml` with build and start commands
3. Push to GitHub repository
4. Connect Render.com to the repository
5. Render will automatically build and deploy

## Project Structure

```
Project/
├── goldsight/                  # Main application directory
│   ├── __init__.py
│   ├── goldsight.py            # Application entry point
│   ├── components/             # Reusable UI components
│   │   ├── navbar.py
│   │   ├── page_layout.py
│   │   └── chapter_progress.py
│   ├── pages/                  # Application pages
│   │   ├── home.py
│   │   ├── data_collection.py
│   │   ├── eda.py
│   │   ├── modeling.py
│   │   └── forecast.py
│   ├── utils/                  # Utility functions
│   │   ├── design_system.py    # Color and typography constants
│   │   └── chart_loader.py     # Plotly chart loading
│   └── data/
│       └── cache/              # Pre-generated Plotly charts (JSON)
├── data/                       # Raw and processed datasets
│   ├── combined_data.csv       # Full dataset (17 features)
│   ├── filtered_data.csv       # Selected features (13 features)
│   ├── raw/                    # Original data sources
│   └── processed/              # Cleaned and transformed data
├── notebooks/                  # Jupyter notebooks
│   ├── explore.ipynb           # Exploratory data analysis
│   └── modeling.ipynb          # Model training and evaluation
├── models/                     # Saved model artifacts
│   ├── best_gru_multivariate.keras
│   ├── best_lstm_multivariate.keras
│   └── ...
├── assets/                     # Static files (images, logos)
├── requirements.txt            # Production dependencies
├── requirements-dev.txt        # Development dependencies
├── render.yaml                 # Render.com deployment configuration
├── rxconfig.py                 # Reflex application configuration
└── README.md                   # This file
```

## Dependencies

### Production Dependencies (requirements.txt)

- `reflex==0.8.17`: Web framework for Python
- `pandas==2.2.2`: Data manipulation and analysis
- `numpy==1.26.4`: Numerical computing
- `plotly==5.24.0`: Interactive visualization
- `openpyxl==3.1.5`: Excel file reading (.xlsx)
- `xlrd==2.0.1`: Excel file reading (.xls)
- `python-dateutil==2.9.0.post0`: Date parsing utilities
- `pytz==2025.2`: Timezone support

### Development Dependencies (requirements-dev.txt)

In addition to production dependencies:
- `jupyter==1.1.1`: Jupyter notebook environment
- `jupyterlab==4.4.4`: JupyterLab IDE
- `matplotlib==3.10.3`: Static plotting
- `seaborn==0.13.2`: Statistical visualization
- `scikit-learn==1.7.1`: Machine learning library
- `statsmodels==0.14.5`: Statistical modeling
- `scipy==1.16.1`: Scientific computing
- `itables==2.4.3`: Interactive pandas tables

See `requirements-dev.txt` for complete list.

## Usage

### Running Jupyter Notebooks

1. Install development dependencies:
```bash
pip install -r requirements-dev.txt
```

2. Launch JupyterLab:
```bash
jupyter lab
```

3. Navigate to `notebooks/` and open:
   - `explore.ipynb`: Data exploration and visualization
   - `modeling.ipynb`: Model training and comparison

### Training Models

Models can be retrained using the provided notebooks or scripts:

```python
import pandas as pd
from sklearn.model_selection import train_test_split

# Load data
df = pd.read_csv('data/filtered_data.csv')

# Prepare features and target
X = df.drop(['Date', 'Gold_Spot'], axis=1)
y = df['Gold_Spot']

# Split data
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, shuffle=False
)

# Train model (example: GRU)
# See notebooks/modeling.ipynb for complete implementation
```

### Accessing the Web Application

**Local Development**:
```bash
reflex run
```
Access at `http://localhost:3000`

**Production**:
Navigate to deployed URL: `https://goldsight.onrender.com`

## Future Work

### Short-term Enhancements

1. **Ensemble Methods**: Implement stacking or blending of top-performing models (GRU, LSTM, Random Forest) to further reduce prediction variance.

2. **Attention Mechanisms**: Integrate attention layers into recurrent architectures to identify which timesteps and features most influence predictions.

3. **Automated Hyperparameter Optimization**: Replace manual GridSearchCV with Bayesian optimization (Optuna) for more efficient hyperparameter search.

4. **Real-time Data Pipeline**: Implement automated data ingestion from APIs to enable live predictions without manual updates.

5. **Prediction Intervals**: Add uncertainty quantification through Monte Carlo dropout or ensemble variance estimation.

### Medium-term Extensions

1. **Regime Detection**: Develop separate models for bull, bear, and crisis market conditions, with automatic regime switching.

2. **Exogenous Event Modeling**: Incorporate binary flags or sentiment scores for major events (Fed policy changes, geopolitical crises).

3. **Multi-horizon Forecasting**: Extend from single-step to multi-step ahead predictions (1-month, 3-month, 6-month).

4. **Feature Expansion**: Integrate alternative data sources (cryptocurrency prices, social media sentiment, central bank speeches).

5. **Explainability Dashboard**: Implement SHAP (SHapley Additive exPlanations) values for model interpretation.

### Long-term Research Directions

1. **Causal Inference**: Move beyond correlation to causal modeling using directed acyclic graphs (DAGs) and instrumental variables.

2. **Transfer Learning**: Investigate whether models trained on gold can be adapted to predict other precious metals (silver, platinum) or commodities.

3. **Reinforcement Learning**: Develop trading strategies that optimize portfolio allocation based on predicted price movements.

4. **Hybrid Physics-Informed Models**: Incorporate economic theory constraints (e.g., Fisher equation for real interest rates) into neural network loss functions.

5. **Cross-Asset Prediction**: Extend to joint modeling of gold, equities, bonds, and currencies in a multivariate framework.

## Contributors

This project was developed as part of the COMP1682.1 Final Project at the University of Greenwich.

**Project Team**:
- Huy Pham (Lead Developer, Data Scientist)
- Repository: https://github.com/HuyPham171-hub/gold-price-prediction

## License

This project is released under the MIT License. See LICENSE file for details.

## Acknowledgments

We acknowledge the following data providers:
- World Gold Council for gold spot price data
- Federal Reserve Economic Data (FRED) for macroeconomic indicators
- CBOE for VIX data
- Economic Policy Uncertainty Index for geopolitical risk measures
- Yahoo Finance for market data

We also thank the open-source community for the development and maintenance of the Python scientific computing ecosystem (NumPy, Pandas, Scikit-learn, TensorFlow/Keras) and the Reflex framework.

## Contact

For questions, suggestions, or collaboration opportunities, please open an issue on the GitHub repository or contact the project maintainer.

---

**Last Updated**: November 2025  
**Version**: 1.0.0  
**Status**: Active Development